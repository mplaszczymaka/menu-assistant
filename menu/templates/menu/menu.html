{% extends 'menu/base.html' %}
{% load static %}

{% block head %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/menu.css' %}">
    <script src="https://kit.fontawesome.com/ef5689f1f5.js" crossorigin="anonymous"></script>

{% endblock head %}

{% block content %}
    <div id="container">
        <div id="search-bar">1</div>

        <div id="filters">2</div>

        <div id="account-opt">3</div>

        <div id="categories">
            {% for category in categories %}
                <a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish_pk_or_name quantity=0 show_basket=show_basket show_similar=False %}"><button class="category sheet">{{ category }}</button></a>
            {% endfor %}
            <a href="{% url 'menu:change_menu' basket_pk %}"><button class="category sheet">Zmień menu</button></a>
        </div>

        <div id="dishes">
            {% for dish in dishes %}
                <button class="dish sheet">
                    <div class="dish-name">
                        {% if dish.is_available == False %}
                            <span><s style="color:rgba(128, 44, 44, 0.2)">{{ dish }}</s></span>
                        {% else %}
                            <span style="color:#ffffff;">{{ dish.name }}</span>
                        {% endif %}
                    </div>
                    <div class="dish-amount-price">
                        {% if dish.is_available == False %}
                            <span><s style="color:rgba(128, 44, 44, 0.2)">{{ dish.amount }}szt {{ dish.price }}zł</s></span>
                        {% else %}
                            <span>{{ dish.amount }}szt {{ dish.price }}zł</span>
                        {% endif %}
                    </div>      
                    <div class="dish-ingredient">
                        {% for ingredient in dish.ingredients.all %}
                            {% if ingredient.is_available == False %}
                                <span><s style="color:rgba(128, 44, 44, 0.2)">{{ ingredient }},</s></span>
                            {% else %}
                                {% if dish.is_available == False %}
                                    <span><s style="color:rgba(128, 44, 44, 0.2)">{{ ingredient }},</s></span>
                                {% else %}
                                    <span>{{ ingredient }},</span>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="dish-add">
                        {% if dish.is_available == True %}
                            <a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish.pk quantity=1 show_basket=show_basket show_similar=False %}">+</a>
                        {% endif %}
                    </div>
                </button>
            {% endfor %}
        </div>

        <div id="small-container">
            <div id="info-img">6</div>
            <div id="summary-extras">
                <div class="summary sheet">
                    <h1>Podsumowanie:</h1>
                    <ul>
                        <li>
                            <p class="count-basket">ilość potraw:<span>{{ count_dishes }}</span></p><hr>
                        </li>
                        <li>
                            <p class="count-basket">liczba sztuk:<span>{{ count_pieces }}</span></p><hr>
                        </li>
                        <li>
                            <p class="count-basket">zestaw dla ok:<span>{{ count_portion }} x <i class="fas fa-male"></i></span></p><hr>
                        </li>
                        <li>
                            <p class="count-basket">cena:<span>{{ count_costs }}zł</span></p><hr>
                        </li>
                    </ul>
                </div>
                <div class="similar-btn">
                    {% comment %} <a href="#">
                        <button onclick="openSimilar()" class="similar-btn sheet">Podobne</button>
                    </a> {% endcomment %}
                    {% if show_similar == "True" %}
                        <a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish_pk_or_name quantity=0 show_basket=False show_similar=False %}">
                                <button class="similar-btn sheet">Podobne</button>
                            </a>
                            <style>
                                .similar {
                                    display: block;
                                }
                            </style>
                    {% else %}
                        <a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish_pk_or_name quantity=0 show_basket=False show_similar=True %}">
                                <button class="similar-btn sheet">Podobne</button>
                            </a>
                            <style>
                                .similar {
                                    display: none;
                                }
                            </style>
                    {% endif %}
                </div>
                <div class="basket-btn">
                    {% if show_basket == "True" %} {# hide basket if its displayed #}
                        <a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish_pk_or_name quantity=0 show_basket=False show_similar=False%}">
                            <button class="basket-btn sheet">Koszyk</button>
                        </a>
                        <style>
                            .basket {
                                display: block;
                            }
                        </style>

                    {% else %}
                        <a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish_pk_or_name quantity=0 show_basket=True show_similar=False %}">
                            <button class="basket-btn sheet">Koszyk</button>
                        </a>
                        <style>
                            .basket {
                                display: none;
                            }
                        </style>
                    {% endif %}
                </div>
                <div class="basket sheet">
                    {% if show_basket == "True" %}
                        <p>Koszyk</p>
                        {% comment %} {% if dish %} {% endcomment %}
                            {% for dish in basket %}
                                <button class="dish-in-basket sheet">
                                    <div class="dish-name">{{ dish }}</div>
                                    <div class="dish-amount-price">{{ dish.quantity }}szt</div>
                                    <div class="dish-add"><a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish.name quantity=1 show_basket=show_basket show_similar=False %}">+</a></div>
                                    <div class="dish-remove"><a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish.name quantity=2 show_basket=show_basket show_similar=False %}">-</a></div>
                                </button>
                            {% endfor %}
                        {% comment %} {% endif %} {% endcomment %}
                    {% endif %}
                </div>
                <div id="similar" class="similar sheet">
                    {% if show_similar == "True" %}
                        <p>Podobne</p>
                        <p>{{ dish }}ddd</p>
                            {% for similar_dish in dish.similar.all %}
                                <button class="dish-in-basket sheet">
                                    <div class="dish-name">{{ similar_dish }}</div>
                                    <div class="dish-amount-price">{{ dish.quantity }}szt</div>
                                    <div class="dish-add"><a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish.name quantity=1 show_basket=show_basket show_similar=False %}">+</a></div>
                                    <div class="dish-remove"><a href="{% url 'menu:menu' menu_pk=menu.pk category_pk=category.pk dish_pk_or_name=dish.name quantity=2 show_basket=show_basket show_similar=False %}">-</a></div>
                                </button>
                            {% endfor %}
                    {% endif %}
                </div>
            </div> 
        </div>
    </div>
    <script src="{% static 'js/javascript.js' %}""></script> 
{% endblock content%}